# MosMetro_Free Authentication
Данный скрипт позволяет автоматизировать подключение к интернету в московском метрополитене (SSID: MosMetro_Free). Скрипт написан на Python 2.x, что позволяет запускать его не только на компьютерах, но и на мобильных устройствах.

Скрипт полностью эмулирует действия пользователя в браузере:
* получает редиректы от маршрутизатора и следует им
* парсит поля input из форм на страницах и отправляет POST запросы с полученными данными
* сохраняет referrer и cookies при переходе на новую страницу

Плюсы:
* отсутствие необходимости нажимать кнопку при потере соединения
* отсутствие рекламы на стадии подключения

Среди минусов данного способа выделяется потеря его работоспособности при изменении порядка авторизации на стороне сервера. Изначально система авторизации вообще не требовала каких-либо наворотов и было достаточно одной строчки на bash.

## Зависимости

* python 2.x
* <a href="http://docs.python-requests.org/en/latest/">python-requests</a>

## Использование

Для авторизации в сети MosMetro_Free просто запустите скрипт. Скрипт сам определит правильность сети и при отсутствии доступа в интернет попытается авторизовать данное устройство.

```
python metro.py
```

Примечание: При первом подключении устройства все-же необходимо пройти авторизацию через SMS или ГосУслуги для регистрации именно этого устройства в сети. После этого скрипт будет нормально работать.

### Автоматизация на Android

Запуск данного скрипта можно автоматизировать в Android при помощи двух программ: QPython (в качестве исполняющей среды Python) и Tasker (или любой программы, умеющей выполнять shell-команды автоматически).

Подробнее об автоматизации на Android вы можете узнать <a href="http://thedrhax.us.to/?p=1768">здесь</a>.

### Автоматизация в Linux

Для автоматического запуска данного скрипта при подключении к сети можно скопировать файл *metro.py* в директорию */etc/network/if-up.d/* и сделать его исполняемым. Для этого вы можете воспользоваться следующими командами, запущенными с правами администратора:

```
cp metro.py /etc/network/if-up.d/metro.py
chmod +x /etc/network/if-up.d/metro.py
```

Также желательно убедиться, что установлены пакеты *python* и *python-requests* (в случае с debian-based системами):

```
apt-get install python python-requests
```

Скрипт будет запускаться при подключении к любой сети, но это не является большой проблемой, так как производится проверка на нужную сеть.
